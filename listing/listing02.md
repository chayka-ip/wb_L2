Что выведет программа? Объяснить вывод программы. Объяснить как работают defer’ы и их порядок вызовов.

```go
package main

import (
	"fmt"
)


func test() (x int) {
	defer func() {
		x++
	}()
	x = 1
	return
}


func anotherTest() int {
	var x int
	defer func() {
		x++
	}()
	x = 1
	return x
}


func main() {
	fmt.Println(test())
	fmt.Println(anotherTest())
}
```

Ответ:
```
2
1

```
- Defer - это отложенный вызов функции. Функции, вызванные с данным модификатором, вызываются после того, как произошел возврат из функции-контекста.
- (1) Очередность вызовов отложенных функций - "первый вошел - последний вышел".
- (2) Аргументы отложенной функции вычисляются в момент объявления вызова данной функции.
- (3) Отложенные функции могут читать и перезаписывать параметры именованных возвращаемых значений.

- Правило (3) обясняет почему функция test() возвращает 2. Когда тело самой функции test() возвращает ранее присвоенное значение 1, вызывается отложенная анонимная функция, инкрементирующая это именованное значение. Эффект был бы тем же самым и в следующем случае:

```go
func test() (x int) {
	defer func() {
		x++
	}()
	return 1
}
```
- Функция anotherTest() не имеет именованных возвращаемых значений, поэтому при возврате во внешнюю область видимости попадет копия переменной х со значением 1, а локальная копия будет инкрементирована отложенной анонимной функцией.